#!/bin/bash

usage() {
    echo "Usage: `basename $0` <all|music> SRC DEST [-f]"
    exit 1
}

cfg=$1
src=$2
dest=$3
[ "$4" = "-f" ] && dry="" || dry="--dry-run"
if [ "$cfg" = "music" ]; then
    args=(-avzO --delete --include='*/' --include='*.txt' --include='cover.*' --exclude='*')
    destdir=$dest:backups/Music
elif [ "$cfg" = "all" ]; then
    args=(-avzO --delete)
    destdir=$dest:backups/$src
else usage
fi
[ ! -z "$src" ] && [ ! -z "$dest" ] && rsync $dry ${args[@]} $src/ $destdir || usage
