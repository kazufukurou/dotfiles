#!/bin/sh

if [ $# -eq 0 ]; then
  echo "Usage: `basename $0` [--start|--start-shuffle|--play|--next|--prev|--add] PATH"
  exit 1
else
  socket=$HOME/.config/mpv/socket
  [ "$1" = "--start" ] && mpv --idle=yes --input-ipc-server=$socket
  [ "$1" = "--start-shuffle" ] && mpv --shuffle --idle=yes --input-ipc-server=$socket
  [ "$1" = "--next" ] && echo 'playlist-next' | socat - "$socket"
  [ "$1" = "--prev" ] && echo 'playlist-prev' | socat - "$socket"
  [ "$1" = "--play" ] && echo 'cycle pause' | socat - "$socket"
  [ "$1" = "--add" ] && path="$2" || path="$1"
  if [ -f "$path" ] || [ -d "$path" ]; then
    [ "$1" = "--add" ] && param="append-play" || param=""
    echo "loadfile \"$path\" $param" | socat - "$socket"
  fi
fi
